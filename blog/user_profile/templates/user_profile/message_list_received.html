{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "received messages" %} | {{ block.super }}{% endblock title %}

{% block content %}
<h1>{% trans "received messages" %}</h1>

{% if message_list_received %}
  {% for message in message_list_received %}
    {% with sender=message.sender %}
      <div>
        <ul class="message_room">
          <li>
            <p>{% trans "date" %}: {{ message.timestamp }}</p>
            <p>{% trans "message text" %}: {{ message.text }}</p>
            {% if message.image %}
              <p>{% trans "image" %}: <img src="{{ message.image.url }}" alt="{% trans "message image"|title %}" width="150"></p>
            {% endif %}
            <p>{% trans "from" %}: &nbsp; 
              <strong>{{ sender }}</strong>
              <div>
                {% if sender == request.user %}
                    {% if sender.profile.picture %}
                        <img src="{{ sender.profile.picture.url }}" alt="{% trans "profile picture"|title %}" width="30">
                    {% endif %}
                {% endif %}
              </div> 
            </p>
            <p>{% trans "To:" %} &nbsp; 
              {% for receiver in message.receiver.all %}
                <strong>{{ receiver }}</strong>
                <div>
                  {% if receiver == request.user %}
                      {% if receiver.profile.picture %}
                          <img src="{{ receiver.profile.picture.url }}" alt="{% trans "profile picture"|title %}" width="30">
                      {% endif %}
                  {% endif %}
                </div>            
                {% if not forloop.last %}, {% endif %}
              {% endfor %}
            </p>
          </li>
        </ul>
      </div>
    {% endwith %}
  {% endfor %}
{% else %}
  <p>{% trans "No received messages." %}</p>
{% endif %}
{% endblock content %}
